<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>ipepe - memes</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<script src="angular.min.js"></script>
	<style type="text/css">
	body, img, div, a {
		text-align: center;
		font-family: sans-serif;
		font-size: 3.5vw;
		border-radius: 10px;
		word-wrap: break-word;
	}
	body{
		background-color: black;
	}
	img{
		max-width: 90%;
		max-height: 50%;
		width: 90%;
		background-color: white;
	}
	div{
		padding: auto;
		margin: auto auto 10px auto;
	}
	.postImg{
		height: 50%;
	}
	.selfText{
		font-size: 1.5vw;
	}
	.footer{
		background-color: #2A2A2A;
		font-size: 1.0vw;
		height: 5vw;
		padding: 0.4vw, 0.2vw;
	}
	.postDiv{
		padding: 10px 5px 5px 5px;
		background-color: #2A2A2A;
		max-width: 95%;
	}
	.titleDiv{
		color: #747474;
		max-width: 95%;
	}
	.loadingDiv{
		color: #747474;
		max-width: 95%;
	}
	.nextImg{
		max-width: 200px;
		max-height: 200px;
	}
	.prevImg{
		max-width: 200px;
		max-height: 200px;
		-moz-transform: scaleX(-1);
		-o-transform: scaleX(-1);
		-webkit-transform: scaleX(-1);
		transform: scaleX(-1);
		filter: FlipH;
		-ms-filter: "FlipH";
	}
	a:link,a:visited, a:active {
		color: #747474;
		text-decoration: none;
	}
	a:hover {
		color: #ababab;
		text-decoration: none;
	}
	@media all and (min-width: 901px){
		div.postDiv{
			max-width: 50%;
			/*max-height: 80%*/
		}
		body, img, div, a {
			font-size: 2.0vw;
		}
	}
	@media all and (max-width: 900px){
		.postDiv{
			max-width: 95%;
			font-weight: bold;
		}
		body, img, div, a {
			font-size: 3.5vw;
		}
	}
	</style>
</head>
<body style="background-color: black;">
	<br>
	<div class="navigationDiv">
		<a id="link2prev" href="index.html" style="visibility: hidden;">
			<img src="next.png" style="background-color: #2A2A2A;" class="prevImg" />
		</a>
		<a id="link2next" href="index.html" style="visibility: hidden;">
			<img src="next.png" style="background-color: #2A2A2A;" class="nextImg" />
		</a>
	</div>
	<br>
	<div class="loadingDiv" id="loadingDiv"><h1>Loading...</h1></div>
	<br>
	<div ng-app="" ng-controller="postsController" class="mainContainer" id="ng-app" style="visibility: hidden;">
		<div class="postDiv" ng-repeat="post in posts" >
			<div class="titleDiv" >
				<a href="{{ post.sourceurl }}" target="_parent"><b>
					{{ post.title }}
				</b></a>
			</div>
			<div class="imageDiv" >
				<a href="{{ post.sourceurl }}" target="_parent">
					<img class="postImg" src="{{ post.url }}"/>
					<!-- <div class="titleDiv">{{ posts.getImgUrl(post.data.url) }}</div> -->
				</a>
			</div>
			<div class="titleDiv selfText" ng-if="post.data.is_self == true">
				{{ post.data.selftext }}
			</div>
		</div>
	</div>
	<br>
	<div class="navigationDiv">
		<a id="link2prev2" href="index.html" style="visibility: hidden;">
			<img src="next.png" style="background-color: #2A2A2A;" class="prevImg" />
		</a>
		<a id="link2next2" href="index.html" style="visibility: hidden;">
			<img src="next.png" style="background-color: #2A2A2A;" class="nextImg" />
		</a>
	</div>
	<div class="footer"><a href="http://www.ipepe.pl/" style="margin: 1vw;">&copy; 2015 Patryk "iPePe" Ptasi≈Ñski. All Rights Reserved.</a></div>

	<script type="text/javascript">
	function getQueryVariable(variable)
	{
		var query = window.location.search.substring(1);
		var vars = query.split("&");
		for (var i=0;i<vars.length;i++) {
			var pair = vars[i].split("=");
			if(pair[0] == variable){return pair[1];}
		}
		return(false);
	}
	function postsController($scope, $http) {
		var p_page = getQueryVariable("page") || 0;
		var httpGetValue = 'http://localhost:8080/handler/memes?page=' + p_page;

		document.getElementById('link2next').style.visibility = 'visible';
		document.getElementById('link2next2').style.visibility = 'visible';
		document.getElementById('ng-app').style.visibility = 'visible';
		document.getElementById('link2prev').style.visibility = 'visible';
		document.getElementById('link2prev2').style.visibility = 'visible';

		$http.get(httpGetValue)
		.success(function(response) {
			if(p_page === 0){
				document.getElementById('link2next').style.visibility = 'visible';
				document.getElementById('link2next2').style.visibility = 'visible';
				document.getElementById('ng-app').style.visibility = 'visible';
				// document.getElementById('link2next').href = 'index2.html?after=' + response.data.after;
				// document.getElementById('link2next2').href = 'index.html?after=' + response.data.after;
				// console.log(response.data.before);
				// console.log(response.data.after);
				if(p_page === 2){
					// console.log(response.data.before)
					document.getElementById('link2prev').style.visibility = 'visible';
					document.getElementById('link2prev2').style.visibility = 'visible';
					// document.getElementById('link2prev').href = 'index2.html?before=' + response.data.before;
					// document.getElementById('link2prev2').href = 'index2.html?before=' + response.data.before;
				}
			}

			document.getElementById('loadingDiv').style.display = "none";
			$scope.posts = response.result;
		});
	}
	</script>
</body>
</html>
